<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RifasPay - MiniApp Completo</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a237e 0%, #311b92 100%);
            color: #333;
            min-height: 100vh;
            padding-bottom: 80px;
        }
        
        .app-container {
            max-width: 500px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
            box-shadow: 0 0 30px rgba(0,0,0,0.2);
            position: relative;
            overflow-x: hidden;
        }
        
        /* Header */
        .header {
            background: linear-gradient(135deg, #1a237e 0%, #311b92 100%);
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 0 0 20px 20px;
            position: relative;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        
        .profile {
            display: flex;
            align-items: center;
        }
        
        .profile-img {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #00c853, #64dd17);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            margin-right: 12px;
        }
        
        .profile-name {
            font-weight: 600;
            font-size: 18px;
        }
        
        .balance-card {
            background: rgba(255,255,255,0.15);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 15px;
            margin-top: 10px;
        }
        
        .balance-label {
            font-size: 14px;
            opacity: 0.8;
            margin-bottom: 5px;
        }
        
        .balance-amount {
            font-size: 28px;
            font-weight: 700;
        }
        
        .deposit-btn {
            background: #00c853;
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 600;
            margin-top: 10px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .deposit-btn:hover {
            background: #00e676;
            transform: translateY(-2px);
        }
        
        /* Menu de Navega√ß√£o */
        .nav-menu {
            display: flex;
            justify-content: space-around;
            background: white;
            border-top: 1px solid #eee;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            max-width: 500px;
            margin: 0 auto;
            z-index: 100;
            padding: 10px 0;
            box-shadow: 0 -5px 15px rgba(0,0,0,0.05);
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 5px 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            color: #666;
            flex: 1;
            text-align: center;
        }
        
        .nav-item.active {
            color: #1a237e;
            background: rgba(26, 35, 126, 0.1);
        }
        
        .nav-icon {
            font-size: 20px;
            margin-bottom: 5px;
        }
        
        .nav-label {
            font-size: 11px;
            font-weight: 500;
        }
        
        /* Conte√∫do das p√°ginas */
        .page {
            display: none;
            padding: 20px;
            animation: fadeIn 0.4s;
            padding-bottom: 30px;
        }
        
        .page.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .page-title {
            font-size: 24px;
            font-weight: 700;
            color: #1a237e;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .page-title i {
            background: #1a237e;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Cards */
        .card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            border: 1px solid #eee;
            transition: all 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .card-title {
            font-size: 18px;
            font-weight: 700;
            color: #1a237e;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .card-title i {
            color: #00c853;
        }
        
        .card-description {
            color: #666;
            margin-bottom: 15px;
            line-height: 1.5;
        }
        
        .card-stats {
            display: flex;
            justify-content: space-between;
            background: #f5f5f5;
            padding: 10px;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        
        .stat {
            text-align: center;
        }
        
        .stat-value {
            font-size: 18px;
            font-weight: 700;
            color: #1a237e;
        }
        
        .stat-label {
            font-size: 12px;
            color: #666;
        }
        
        .btn {
            background: #1a237e;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn:hover {
            background: #311b92;
        }
        
        .btn-secondary {
            background: #f5f5f5;
            color: #333;
        }
        
        .btn-secondary:hover {
            background: #e0e0e0;
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 25px;
            max-width: 400px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .modal-title {
            font-size: 22px;
            font-weight: 700;
            color: #1a237e;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }
        
        .qrcode-container {
            text-align: center;
            margin: 20px 0;
        }
        
        #qrcode-image {
            max-width: 250px;
            border: 1px solid #ddd;
            border-radius: 10px;
            padding: 10px;
        }
        
        /* Painel Admin (s√≥ vis√≠vel para voc√™) */
        .admin-badge {
            background: #ff4081;
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 10px;
        }
        
        .admin-section {
            border-left: 4px solid #ff4081;
            padding-left: 15px;
            margin-top: 20px;
        }
        
        .admin-controls {
            display: grid;
            gap: 10px;
            margin-top: 15px;
        }
        
        .admin-input {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 8px;
            width: 100%;
        }
        
        /* Ranking */
        .ranking-item {
            display: flex;
            align-items: center;
            padding: 12px;
            border-bottom: 1px solid #eee;
            background: #fafafa;
            border-radius: 10px;
            margin-bottom: 8px;
        }
        
        .rank-position {
            font-size: 20px;
            font-weight: 700;
            width: 40px;
            text-align: center;
            color: #666;
        }
        
        .rank-user {
            flex: 1;
            margin-left: 10px;
        }
        
        .rank-user-name {
            font-weight: 600;
            font-size: 16px;
        }
        
        .rank-value {
            font-size: 16px;
            font-weight: 700;
            color: #00c853;
        }
        
        /* Status */
        .status {
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 15px;
            text-align: center;
            font-weight: 500;
            display: none;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            display: block;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            display: block;
        }
        
        .status.loading {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
            display: block;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Cabe√ßalho com saldo -->
        <div class="header">
            <div class="user-info">
                <div class="profile">
                    <div class="profile-img" id="profile-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div>
                        <div class="profile-name" id="user-name">@rifaspayuser</div>
                        <div style="font-size: 14px; opacity: 0.8;" id="user-id">ID: ---</div>
                    </div>
                </div>
                <div>
                    <i class="fas fa-bell" style="font-size: 22px; opacity: 0.8; cursor: pointer;" onclick="showPage('notificacoes-page')"></i>
                </div>
            </div>
            
            <div class="balance-card">
                <div class="balance-label">SALDO DISPON√çVEL</div>
                <div class="balance-amount" id="user-balance">R$ 0,00</div>
                <button class="deposit-btn" onclick="abrirModalDeposito()">
                    <i class="fas fa-plus-circle"></i> Depositar via PIX
                </button>
            </div>
        </div>
        
        <!-- P√°gina de Gincanas -->
        <div id="gincanas-page" class="page active">
            <div class="page-title">
                <i class="fas fa-trophy"></i> Gincanas
                <span id="admin-badge" style="display: none;" class="admin-badge">ADMIN</span>
            </div>
            
            <div id="admin-section" class="admin-section" style="display: none;">
                <h3 style="color: #ff4081; margin-bottom: 10px;">‚öôÔ∏è Painel Administrativo</h3>
                <div class="admin-controls">
                    <input type="number" id="admin-add-saldo" class="admin-input" placeholder="Valor para adicionar (R$)">
                    <input type="text" id="admin-user-id" class="admin-input" placeholder="ID do usu√°rio">
                    <button class="btn" onclick="adminAdicionarSaldo()" style="background: #ff4081;">
                        <i class="fas fa-plus"></i> Adicionar Saldo
                    </button>
                    <button class="btn" onclick="adminVerTodosUsuarios()" style="background: #2196f3;">
                        <i class="fas fa-users"></i> Ver Todos Usu√°rios
                    </button>
                    <button class="btn" onclick="adminResetarRankings()" style="background: #ff9800;">
                        <i class="fas fa-sync-alt"></i> Resetar Rankings
                    </button>
                </div>
            </div>
            
            <div class="card">
                <div class="card-title">
                    <i class="fas fa-crown"></i> Desafio dos 7 Dias
                </div>
                <div class="card-description">
                    Complete desafios di√°rios e suba no ranking. O pr√™mio total √© distribu√≠do entre os top 3!
                </div>
                <div class="card-stats">
                    <div class="stat">
                        <div class="stat-value">R$ 15</div>
                        <div class="stat-label">Inscri√ß√£o</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value">R$ 1.500</div>
                        <div class="stat-label">Pr√™mio Total</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value">0</div>
                        <div class="stat-label">Participantes</div>
                    </div>
                </div>
                <button class="btn" onclick="participarGincana(15)">
                    <i class="fas fa-play-circle"></i> Participar Agora
                </button>
            </div>
            
            <button class="btn btn-secondary" onclick="criarNovaGincana()">
                <i class="fas fa-plus"></i> Criar Nova Gincana
            </button>
        </div>
        
        <!-- P√°gina de Ganhar Dinheiro -->
        <div id="ganhar-page" class="page">
            <div class="page-title">
                <i class="fas fa-money-bill-wave"></i> Ganhar Dinheiro
            </div>
            
            <div class="card">
                <div class="card-title">
                    <i class="fas fa-coins"></i> Miss√µes Dispon√≠veis
                </div>
                <div class="card-description">
                    Complete tarefas simples e ganhe saldo para usar nas rifas e gincanas!
                </div>
                
                <div class="mission-item" style="display: flex; align-items: center; padding: 15px 0; border-bottom: 1px solid #eee;">
                    <div class="mission-icon" style="width: 50px; height: 50px; background: linear-gradient(135deg, #ff9800, #ff5722); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-size: 22px; margin-right: 15px;">
                        <i class="fas fa-play-circle"></i>
                    </div>
                    <div style="flex: 1;">
                        <div style="font-weight: 600; margin-bottom: 5px;">Assista este v√≠deo</div>
                        <div style="font-size: 14px; color: #666;">Assista o v√≠deo completo (30 segundos)</div>
                    </div>
                    <div class="mission-reward" onclick="completarMissao(0.50)" style="background: #4caf50; color: white; padding: 5px 12px; border-radius: 20px; font-weight: 600; cursor: pointer;">R$ 0,50</div>
                </div>
                
                <div class="mission-item" style="display: flex; align-items: center; padding: 15px 0; border-bottom: 1px solid #eee;">
                    <div class="mission-icon" style="width: 50px; height: 50px; background: linear-gradient(135deg, #2196f3, #0d47a1); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-size: 22px; margin-right: 15px;">
                        <i class="fas fa-mobile-alt"></i>
                    </div>
                    <div style="flex: 1;">
                        <div style="font-weight: 600; margin-bottom: 5px;">Instale e use este app</div>
                        <div style="font-size: 14px; color: #666;">Use por 5 minutos e ganhe</div>
                    </div>
                    <div class="mission-reward" onclick="completarMissao(2.50)" style="background: #4caf50; color: white; padding: 5px 12px; border-radius: 20px; font-weight: 600; cursor: pointer;">R$ 2,50</div>
                </div>
            </div>
        </div>
        
        <!-- P√°gina de Rifas -->
        <div id="rifas-page" class="page">
            <div class="page-title">
                <i class="fas fa-ticket-alt"></i> Rifas
            </div>
            
            <div class="rifa-type-selector" style="display: flex; margin-bottom: 20px; background: #f5f5f5; border-radius: 10px; padding: 5px;">
                <div class="rifa-type active" onclick="changeRifaType('tradicional')" style="flex: 1; text-align: center; padding: 10px; border-radius: 8px; cursor: pointer; font-weight: 600; background: white; box-shadow: 0 3px 10px rgba(0,0,0,0.1);">
                    Tradicionais
                </div>
                <div class="rifa-type" onclick="changeRifaType('rapidinha')" style="flex: 1; text-align: center; padding: 10px; border-radius: 8px; cursor: pointer; font-weight: 600;">
                    Rapidinha
                </div>
            </div>
            
            <!-- Rifas Tradicionais -->
            <div id="rifas-tradicionais">
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-gamepad"></i> PlayStation 5
                    </div>
                    <div class="card-description">
                        1x PlayStation 5 Digital Edition nova na caixa. Sorteio quando todos os n√∫meros forem vendidos.
                    </div>
                    <div class="card-stats">
                        <div class="stat">
                            <div class="stat-value">R$ 10</div>
                            <div class="stat-label">Por n√∫mero</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">0%</div>
                            <div class="stat-label">Vendidos</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">30 dias</div>
                            <div class="stat-label">Restantes</div>
                        </div>
                    </div>
                    <button class="btn" onclick="comprarNumeroRifa(10)">
                        <i class="fas fa-shopping-cart"></i> Comprar N√∫meros
                    </button>
                </div>
                
                <button class="btn btn-secondary" onclick="criarNovaRifa()">
                    <i class="fas fa-plus"></i> Criar Nova Rifa
                </button>
            </div>
            
            <!-- Rapidinha -->
            <div id="rifas-rapidinha" style="display: none;">
                <div class="rapidinha-timer" style="background: linear-gradient(135deg, #ff4081, #f50057); color: white; text-align: center; padding: 15px; border-radius: 15px; margin-bottom: 20px;">
                    <div class="timer-label">PR√ìXIMO SORTEIO EM</div>
                    <div class="timer-value" id="rapidinha-timer">05:00</div>
                    <div class="timer-label">POTE ATUAL: <span id="rapidinha-pote">R$ 0,00</span></div>
                </div>
                
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-bolt"></i> Rapidinha R$ 500
                    </div>
                    <div class="card-description">
                        Compre bilhetes por R$ 2,00 cada. Quando o tempo acabar, um ganhador leva 70% do pote!
                    </div>
                    <div class="card-stats">
                        <div class="stat">
                            <div class="stat-value">R$ 2</div>
                            <div class="stat-label">Por bilhete</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">0</div>
                            <div class="stat-label">Bilhetes</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">R$ 0</div>
                            <div class="stat-label">Pr√™mio</div>
                        </div>
                    </div>
                    
                    <button class="btn" style="background: linear-gradient(135deg, #ff4081, #f50057);" onclick="comprarRapidinha(2)">
                        <i class="fas fa-bolt"></i> Comprar Bilhete
                    </button>
                </div>
            </div>
        </div>
        
        <!-- P√°gina de Ranking -->
        <div id="ranking-page" class="page">
            <div class="page-title">
                <i class="fas fa-trophy"></i> Rankings
            </div>
            
            <div class="ranking-selector" style="display: flex; background: #f5f5f5; border-radius: 10px; padding: 5px; margin-bottom: 20px;">
                <div class="ranking-tab active" onclick="changeRankingType('depositos')" style="flex: 1; text-align: center; padding: 12px 5px; border-radius: 8px; cursor: pointer; font-weight: 600; background: white; box-shadow: 0 3px 10px rgba(0,0,0,0.1); color: #1a237e; display: flex; align-items: center; justify-content: center; gap: 8px;">
                    <i class="fas fa-money-bill-wave"></i> Top Dep√≥sitos
                </div>
                <div class="ranking-tab" onclick="changeRankingType('pontos')" style="flex: 1; text-align: center; padding: 12px 5px; border-radius: 8px; cursor: pointer; font-weight: 600; display: flex; align-items: center; justify-content: center; gap: 8px;">
                    <i class="fas fa-star"></i> Top Pontos
                </div>
            </div>
            
            <!-- Ranking de Dep√≥sitos -->
            <div id="ranking-depositos">
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-medal"></i> Top 10 Maiores Dep√≥sitos
                    </div>
                    <div id="ranking-depositos-list">
                        <!-- Ranking carregado automaticamente -->
                    </div>
                </div>
            </div>
            
            <!-- Ranking de Pontos -->
            <div id="ranking-pontos" style="display: none;">
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-crown"></i> Top 10 Maiores Pontua√ß√µes
                    </div>
                    <div id="ranking-pontos-list">
                        <!-- Ranking carregado automaticamente -->
                    </div>
                </div>
            </div>
            
            <!-- Sua Posi√ß√£o -->
            <div class="your-position-card" style="background: linear-gradient(135deg, #1a237e, #311b92); color: white; border-radius: 15px; padding: 20px; margin-top: 25px; text-align: center;">
                <div class="your-position-title" id="position-title" style="font-size: 16px; opacity: 0.9; margin-bottom: 10px;">SUA POSI√á√ÉO NO RANKING</div>
                <div class="your-position-value" id="user-position" style="font-size: 32px; font-weight: 700; margin-bottom: 5px;">#--</div>
                <div style="font-size: 18px; opacity: 0.9;" id="user-position-value">Carregando...</div>
                <button class="refresh-btn" onclick="atualizarRankings()" style="background: rgba(255,255,255,0.2); color: white; border: none; padding: 10px 20px; border-radius: 20px; font-weight: 600; cursor: pointer; margin-top: 15px; display: inline-flex; align-items: center; gap: 8px;">
                    <i class="fas fa-sync-alt"></i> Atualizar Ranking
                </button>
            </div>
        </div>
        
        <!-- P√°gina de Perfil -->
        <div id="perfil-page" class="page">
            <div class="page-title">
                <i class="fas fa-user-circle"></i> Meu Perfil
            </div>
            
            <div style="text-align: center;">
                <div class="profile-avatar" id="profile-avatar-large" style="width: 100px; height: 100px; background: linear-gradient(135deg, #1a237e, #311b92); border-radius: 50%; margin: 0 auto 20px; display: flex; align-items: center; justify-content: center; font-size: 40px; color: white;">
                    <i class="fas fa-user"></i>
                </div>
                <div style="margin-bottom: 30px;">
                    <div style="font-size: 24px; font-weight: 700;" id="profile-username">@usuariotelegram</div>
                    <div style="color: #666; margin-top: 5px;" id="profile-join-date">Membro desde hoje</div>
                </div>
                
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-chart-line"></i> Estat√≠sticas
                    </div>
                    <div class="card-stats">
                        <div class="stat">
                            <div class="stat-value" id="profile-balance">R$ 0,00</div>
                            <div class="stat-label">Saldo</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value" id="profile-rifas">0</div>
                            <div class="stat-label">Rifas</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value" id="profile-ranking">#--</div>
                            <div class="stat-label">Melhor Ranking</div>
                        </div>
                    </div>
                </div>
                
                <button class="btn" style="margin-top: 20px; background: linear-gradient(135deg, #ff4081, #f50057);" onclick="showPage('ranking-page')">
                    <i class="fas fa-trophy"></i> Ver Meu Ranking
                </button>
                
                <button class="btn btn-secondary" style="margin-top: 10px;" onclick="sairConta()">
                    <i class="fas fa-sign-out-alt"></i> Sair da Conta
                </button>
            </div>
        </div>
        
        <!-- Modal de Dep√≥sito PIX -->
        <div id="deposit-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title">üí≥ Depositar via PIX</div>
                    <button class="close-modal" onclick="fecharModalDeposito()">√ó</button>
                </div>
                
                <div class="status" id="deposit-status"></div>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600;">Valor do Dep√≥sito (M√≠nimo: R$ 10,00)</label>
                    <input type="number" id="deposit-amount" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px;" min="10" step="0.01" value="10.00">
                </div>
                
                <div id="qrcode-section" style="display: none;">
                    <div class="qrcode-container">
                        <img id="qrcode-image" src="" alt="QR Code PIX">
                    </div>
                    <div style="margin: 15px 0;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600;">C√≥digo PIX (Copia e Cola)</label>
                        <input type="text" id="pix-code" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-family: monospace;" readonly>
                        <button class="btn" onclick="copiarCodigoPix()" style="margin-top: 10px; background: #2196f3;">
                            <i class="fas fa-copy"></i> Copiar C√≥digo
                        </button>
                    </div>
                </div>
                
                <button class="btn" onclick="gerarPixDeposito()" id="generate-pix-btn">
                    <i class="fas fa-qrcode"></i> Gerar QR Code PIX
                </button>
                
                <button class="btn btn-secondary" onclick="fecharModalDeposito()" style="margin-top: 10px;">
                    <i class="fas fa-times"></i> Cancelar
                </button>
            </div>
        </div>
        
        <!-- Menu de navega√ß√£o -->
        <div class="nav-menu">
            <div class="nav-item active" onclick="showPage('gincanas-page')">
                <div class="nav-icon">
                    <i class="fas fa-trophy"></i>
                </div>
                <div class="nav-label">Gincanas</div>
            </div>
            <div class="nav-item" onclick="showPage('ganhar-page')">
                <div class="nav-icon">
                    <i class="fas fa-money-bill-wave"></i>
                </div>
                <div class="nav-label">Ganhar</div>
            </div>
            <div class="nav-item" onclick="showPage('rifas-page')">
                <div class="nav-icon">
                    <i class="fas fa-ticket-alt"></i>
                </div>
                <div class="nav-label">Rifas</div>
            </div>
            <div class="nav-item" onclick="showPage('ranking-page')">
                <div class="nav-icon">
                    <i class="fas fa-medal"></i>
                </div>
                <div class="nav-label">Ranking</div>
            </div>
            <div class="nav-item" onclick="showPage('perfil-page')">
                <div class="nav-icon">
                    <i class="fas fa-user"></i>
                </div>
                <div class="nav-label">Perfil</div>
            </div>
        </div>
    </div>

    <script>
        // ==================== CONFIGURA√á√ïES GLOBAIS ====================
        const ADMIN_TELEGRAM_ID = "8058168121"; // SEU ID
        const PIXGO_API_KEY = "pk_f86992c03f3ffadaff660e44b326431b26f6f83eda4caf3f57c9579d3bdecb74";
        
        // Configura√ß√£o do Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyBsk295-CSkpOEk6fxkhdXmYaTXsYp6BiI",
            authDomain: "rifaspay-cb30e.firebaseapp.com",
            projectId: "rifaspay-cb30e",
            storageBucket: "rifaspay-cb30e.firebasestorage.app",
            messagingSenderId: "434795899894",
            appId: "1:434795899894:web:9796fb75b9d28fe78fb5d7"
        };
        
        // Inicializar Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        
        // Dados do usu√°rio atual
        let currentUser = null;
        let isAdmin = false;
        
        // ==================== INICIALIZA√á√ÉO ====================
        document.addEventListener('DOMContentLoaded', async function() {
            console.log("üöÄ RifasPay iniciando...");
            
            // Verificar se est√° no Telegram
            if (window.Telegram && Telegram.WebApp) {
                await inicializarUsuarioTelegram();
            } else {
                // Modo de desenvolvimento (sem Telegram)
                console.log("‚ö†Ô∏è Executando em modo desenvolvimento");
                currentUser = {
                    id: "dev_" + Date.now(),
                    first_name: "Desenvolvedor",
                    username: "@dev",
                    isAdmin: true
                };
                isAdmin = true;
                mostrarDadosUsuario();
                mostrarPainelAdmin();
            }
            
            // Carregar dados iniciais
            carregarRankings();
            iniciarTimers();
        });
        
        // ==================== SISTEMA DE USU√ÅRIOS ====================
        async function inicializarUsuarioTelegram() {
            try {
                const telegramData = Telegram.WebApp.initDataUnsafe;
                const user = telegramData?.user;
                
                if (!user) {
                    console.error("Usu√°rio do Telegram n√£o encontrado");
                    return;
                }
                
                // Verificar se √© admin
                isAdmin = (user.id.toString() === ADMIN_TELEGRAM_ID);
                
                // Criar/atualizar usu√°rio no Firebase
                currentUser = {
                    id: user.id.toString(),
                    first_name: user.first_name || "",
                    last_name: user.last_name || "",
                    username: user.username || `user_${user.id}`,
                    isAdmin: isAdmin,
                    language_code: user.language_code || "pt-br"
                };
                
                // Salvar no Firebase
                await db.collection("usuarios").doc(currentUser.id).set({
                    ...currentUser,
                    ultimo_login: new Date().toISOString(),
                    criado_em: firebase.firestore.FieldValue.serverTimestamp()
                }, { merge: true });
                
                // Mostrar dados na interface
                mostrarDadosUsuario();
                
                // Mostrar painel admin se for admin
                if (isAdmin) {
                    mostrarPainelAdmin();
                }
                
                console.log("‚úÖ Usu√°rio inicializado:", currentUser);
                
            } catch (error) {
                console.error("Erro ao inicializar usu√°rio:", error);
            }
        }
        
        function mostrarDadosUsuario() {
            if (!currentUser) return;
            
            document.getElementById('user-name').textContent = `@${currentUser.username}`;
            document.getElementById('user-id').textContent = `ID: ${currentUser.id}`;
            document.getElementById('profile-username').textContent = `@${currentUser.username}`;
            
            if (isAdmin) {
                document.getElementById('admin-badge').style.display = 'inline-block';
            }
            
            // Carregar saldo do usu√°rio
            carregarSaldoUsuario();
        }
        
        async function carregarSaldoUsuario() {
            if (!currentUser) return;
            
            try {
                const userDoc = await db.collection("usuarios").doc(currentUser.id).get();
                if (userDoc.exists) {
                    const userData = userDoc.data();
                    const saldo = userData.saldo || 0;
                    
                    // Atualizar interface
                    document.getElementById('user-balance').textContent = `R$ ${saldo.toFixed(2)}`;
                    document.getElementById('profile-balance').textContent = `R$ ${saldo.toFixed(2)}`;
                }
            } catch (error) {
                console.error("Erro ao carregar saldo:", error);
            }
        }
        
        // ==================== SISTEMA DE DEP√ìSITO PIX ====================
        let currentPaymentId = null;
        let paymentCheckInterval = null;
        
        function abrirModalDeposito() {
            document.getElementById('deposit-modal').style.display = 'flex';
            document.getElementById('qrcode-section').style.display = 'none';
            document.getElementById('deposit-status').style.display = 'none';
            document.getElementById('deposit-amount').value = "10.00";
        }
        
        function fecharModalDeposito() {
            document.getElementById('deposit-modal').style.display = 'none';
            if (paymentCheckInterval) {
                clearInterval(paymentCheckInterval);
                paymentCheckInterval = null;
            }
        }
        
        async function gerarPixDeposito() {
            if (!currentUser) {
                mostrarStatusDeposito("‚ùå Fa√ßa login primeiro!", "error");
                return;
            }
            
            const amount = parseFloat(document.getElementById('deposit-amount').value);
            if (amount < 10) {
                mostrarStatusDeposito("‚ùå Valor m√≠nimo √© R$ 10,00", "error");
                return;
            }
            
            mostrarStatusDeposito("üîÑ Gerando QR Code PIX...", "loading");
            document.getElementById('generate-pix-btn').disabled = true;
            
            try {
                // Gerar PIX usando API PixGo
                const response = await fetch('https://pixgo.org/api/v1/payment/create', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-API-Key': PIXGO_API_KEY
                    },
                    body: JSON.stringify({
                        amount: amount,
                        description: `Dep√≥sito RifasPay - ${currentUser.username}`,
                        customer_name: currentUser.first_name || currentUser.username,
                        customer_cpf: "00000000000",
                        external_id: `dep_${currentUser.id}_${Date.now()}`
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    currentPaymentId = data.data.payment_id;
                    
                    // Mostrar QR Code
                    document.getElementById('qrcode-image').src = data.data.qr_image_url;
                    document.getElementById('pix-code').value = data.data.qr_code;
                    document.getElementById('qrcode-section').style.display = 'block';
                    
                    mostrarStatusDeposito("‚úÖ QR Code gerado! Escaneie para pagar.", "success");
                    
                    // Registrar transa√ß√£o no Firebase
                    await db.collection("transacoes").doc(currentPaymentId).set({
                        payment_id: currentPaymentId,
                        user_id: currentUser.id,
                        username: currentUser.username,
                        amount: amount,
                        status: "pending",
                        qr_code: data.data.qr_code,
                        qr_image_url: data.data.qr_image_url,
                        created_at: new Date().toISOString(),
                        expires_at: data.data.expires_at
                    });
                    
                    // Iniciar verifica√ß√£o do pagamento
                    iniciarVerificacaoPagamento();
                    
                } else {
                    mostrarStatusDeposito(`‚ùå Erro: ${data.message || "Falha ao gerar PIX"}`, "error");
                }
                
            } catch (error) {
                console.error("Erro ao gerar PIX:", error);
                mostrarStatusDeposito("‚ùå Erro de conex√£o com a API", "error");
            } finally {
                document.getElementById('generate-pix-btn').disabled = false;
            }
        }
        
        function mostrarStatusDeposito(mensagem, tipo) {
            const statusEl = document.getElementById('deposit-status');
            statusEl.textContent = mensagem;
            statusEl.className = `status ${tipo}`;
            statusEl.style.display = 'block';
        }
        
        function copiarCodigoPix() {
            const codigoInput = document.getElementById('pix-code');
            codigoInput.select();
            document.execCommand('copy');
            
            // Feedback visual
            const originalValue = codigoInput.value;
            codigoInput.value = "‚úÖ C√≥digo copiado!";
            setTimeout(() => {
                codigoInput.value = originalValue;
            }, 2000);
        }
        
        function iniciarVerificacaoPagamento() {
            if (paymentCheckInterval) {
                clearInterval(paymentCheckInterval);
            }
            
            paymentCheckInterval = setInterval(async () => {
                if (!currentPaymentId) return;
                
                try {
                    // Verificar status do pagamento
                    const response = await fetch(`https://pixgo.org/api/v1/payment/${currentPaymentId}/status`, {
                        headers: {
                            'X-API-Key': PIXGO_API_KEY
                        }
                    });
                    
                    const data = await response.json();
                    
                    if (data.success && data.data.status === "completed") {
                        // Pagamento confirmado!
                        clearInterval(paymentCheckInterval);
                        
                        // Atualizar transa√ß√£o no Firebase
                        await db.collection("transacoes").doc(currentPaymentId).update({
                            status: "completed",
                            completed_at: new Date().toISOString()
                        });
                        
                        // Atualizar saldo do usu√°rio
                        await atualizarSaldoUsuario(data.data.amount);
                        
                        mostrarStatusDeposito("‚úÖ Pagamento confirmado! Saldo atualizado.", "success");
                        
                        // Atualizar interface ap√≥s 3 segundos
                        setTimeout(() => {
                            fecharModalDeposito();
                            carregarSaldoUsuario();
                            atualizarRankings();
                        }, 3000);
                    }
                    
                } catch (error) {
                    console.error("Erro ao verificar pagamento:", error);
                }
            }, 5000); // Verificar a cada 5 segundos
        }
        
        async function atualizarSaldoUsuario(amount) {
            if (!currentUser) return;
            
            try {
                const userRef = db.collection("usuarios").doc(currentUser.id);
                const userDoc = await userRef.get();
                
                if (userDoc.exists) {
                    const userData = userDoc.data();
                    const novoSaldo = (userData.saldo || 0) + amount;
                    
                    await userRef.update({
                        saldo: novoSaldo,
                        total_depositado: (userData.total_depositado || 0) + amount,
                        ultimo_deposito: new Date().toISOString()
                    });
                    
                    // Atualizar ranking de dep√≥sitos
                    await atualizarRankingDepositos(currentUser.id, amount);
                    
                    console.log("‚úÖ Saldo atualizado para:", novoSaldo);
                }
            } catch (error) {
                console.error("Erro ao atualizar saldo:", error);
            }
        }
        
        // ==================== SISTEMA DE RANKING ====================
        async function atualizarRankingDepositos(userId, amount) {
            try {
                const rankingRef = db.collection("ranking_depositos").doc(userId);
                const rankingDoc = await rankingRef.get();
                
                if (rankingDoc.exists) {
                    await rankingRef.update({
                        valor_total: firebase.firestore.FieldValue.increment(amount),
                        ultima_atualizacao: new Date().toISOString()
                    });
                } else {
                    const userDoc = await db.collection("usuarios").doc(userId).get();
                    const userData = userDoc.data();
                    
                    await rankingRef.set({
                        user_id: userId,
                        username: userData.username,
                        valor_total: amount,
                        ultima_atualizacao: new Date().toISOString()
                    });
                }
                
                // Recarregar rankings
                carregarRankings();
                
            } catch (error) {
                console.error("Erro ao atualizar ranking:", error);
            }
        }
        
        async function carregarRankings() {
            await carregarRankingDepositos();
            await carregarRankingPontos();
        }
        
        async function carregarRankingDepositos() {
            try {
                const querySnapshot = await db.collection("ranking_depositos")
                    .orderBy("valor_total", "desc")
                    .limit(10)
                    .get();
                
                const container = document.getElementById('ranking-depositos-list');
                container.innerHTML = '';
                
                let posicao = 1;
                let minhaPosicao = null;
                let meuValor = 0;
                
                querySnapshot.forEach((doc) => {
                    const data = doc.data();
                    const isCurrentUser = currentUser && data.user_id === currentUser.id;
                    
                    if (isCurrentUser) {
                        minhaPosicao = posicao;
                        meuValor = data.valor_total;
                    }
                    
                    const rankingItem = document.createElement('div');
                    rankingItem.className = 'ranking-item';
                    rankingItem.innerHTML = `
                        <div class="rank-position">${posicao}</div>
                        <div class="rank-user">
                            <div class="rank-user-name">
                                ${data.username} ${isCurrentUser ? '<span style="color: #00c853;">(Voc√™)</span>' : ''}
                            </div>
                            <div class="rank-user-stats">${posicao === 1 ? 'üèÜ Maior dep√≥sito' : 'Ativo'}</div>
                        </div>
                        <div class="rank-value">R$ ${data.valor_total?.toFixed(2) || '0.00'}</div>
                    `;
                    
                    container.appendChild(rankingItem);
                    posicao++;
                });
                
                // Atualizar minha posi√ß√£o
                if (minhaPosicao) {
                    document.getElementById('user-position').textContent = `#${minhaPosicao}`;
                    document.getElementById('user-position-value').textContent = `R$ ${meuValor.toFixed(2)} depositados`;
                    document.getElementById('position-title').textContent = 'SUA POSI√á√ÉO NO RANKING DE DEP√ìSITOS';
                }
                
            } catch (error) {
                console.error("Erro ao carregar ranking de dep√≥sitos:", error);
            }
        }
        
        async function carregarRankingPontos() {
            // Implementa√ß√£o similar para ranking de pontos
            const container = document.getElementById('ranking-pontos-list');
            container.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">Ranking de pontos em desenvolvimento...</p>';
        }
        
        function changeRankingType(type) {
            const depositosTab = document.querySelectorAll('.ranking-tab')[0];
            const pontosTab = document.querySelectorAll('.ranking-tab')[1];
            const depositosDiv = document.getElementById('ranking-depositos');
            const pontosDiv = document.getElementById('ranking-pontos');
            
            if (type === 'depositos') {
                depositosTab.classList.add('active');
                pontosTab.classList.remove('active');
                depositosDiv.style.display = 'block';
                pontosDiv.style.display = 'none';
            } else {
                depositosTab.classList.remove('active');
                pontosTab.classList.add('active');
                depositosDiv.style.display = 'none';
                pontosDiv.style.display = 'block';
            }
        }
        
        function atualizarRankings() {
            carregarRankings();
            mostrarStatusTemporario("üîÑ Rankings atualizados!", "success");
        }
        
        // ==================== PAINEL ADMINISTRATIVO ====================
        function mostrarPainelAdmin() {
            if (isAdmin) {
                document.getElementById('admin-section').style.display = 'block';
            }
        }
        
        async function adminAdicionarSaldo() {
            if (!isAdmin) return;
            
            const userId = document.getElementById('admin-user-id').value;
            const amount = parseFloat(document.getElementById('admin-add-saldo').value);
            
            if (!userId || !amount || amount <= 0) {
                alert("Preencha todos os campos corretamente!");
                return;
            }
            
            try {
                const userRef = db.collection("usuarios").doc(userId);
                const userDoc = await userRef.get();
                
                if (!userDoc.exists) {
                    alert("Usu√°rio n√£o encontrado!");
                    return;
                }
                
                await userRef.update({
                    saldo: firebase.firestore.FieldValue.increment(amount)
                });
                
                // Registrar transa√ß√£o administrativa
                await db.collection("transacoes_admin").add({
                    admin_id: currentUser.id,
                    user_id: userId,
                    amount: amount,
                    type: "admin_add",
                    timestamp: new Date().toISOString()
                });
                
                alert(`‚úÖ R$ ${amount.toFixed(2)} adicionados ao usu√°rio ${userId}`);
                
                // Limpar campos
                document.getElementById('admin-user-id').value = '';
                document.getElementById('admin-add-saldo').value = '';
                
            } catch (error) {
                console.error("Erro ao adicionar saldo:", error);
                alert("Erro ao adicionar saldo!");
            }
        }
        
        async function adminVerTodosUsuarios() {
            if (!isAdmin) return;
            
            try {
                const querySnapshot = await db.collection("usuarios").limit(50).get();
                let mensagem = "üìä LISTA DE USU√ÅRIOS:\n\n";
                
                querySnapshot.forEach((doc) => {
                    const data = doc.data();
                    mensagem += `@${data.username} (ID: ${doc.id})\n`;
                    mensagem += `Saldo: R$ ${data.saldo?.toFixed(2) || '0.00'}\n`;
                    mensagem += `---\n`;
                });
                
                alert(mensagem);
            } catch (error) {
                console.error("Erro ao buscar usu√°rios:", error);
            }
        }
        
        async function adminResetarRankings() {
            if (!isAdmin) return;
            
            if (confirm("‚ö†Ô∏è Tem certeza que deseja resetar TODOS os rankings? Esta a√ß√£o n√£o pode ser desfeita.")) {
                try {
                    // Implementar reset de rankings aqui
                    alert("‚úÖ Rankings resetados com sucesso!");
                } catch (error) {
                    console.error("Erro ao resetar rankings:", error);
                }
            }
        }
        
        // ==================== FUNCIONALIDADES B√ÅSICAS ====================
        function showPage(pageId) {
            // Esconder todas as p√°ginas
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Mostrar p√°gina selecionada
            document.getElementById(pageId).classList.add('active');
            
            // Atualizar menu de navega√ß√£o
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Encontrar e ativar item correspondente
            const navItems = document.querySelectorAll('.nav-item');
            for (let i = 0; i < navItems.length; i++) {
                if (navItems[i].onclick.toString().includes(pageId)) {
                    navItems[i].classList.add('active');
                    break;
                }
            }
        }
        
        function changeRifaType(type) {
            const tradicional = document.getElementById('rifas-tradicionais');
            const rapidinha = document.getElementById('rifas-rapidinha');
            const tradicionalBtn = document.querySelectorAll('.rifa-type')[0];
            const rapidinhaBtn = document.querySelectorAll('.rifa-type')[1];
            
            if (type === 'tradicional') {
                tradicional.style.display = 'block';
                rapidinha.style.display = 'none';
                tradicionalBtn.classList.add('active');
                rapidinhaBtn.classList.remove('active');
            } else {
                tradicional.style.display = 'none';
                rapidinha.style.display = 'block';
                tradicionalBtn.classList.remove('active');
                rapidinhaBtn.classList.add('active');
            }
        }
        
        async function completarMissao(valor) {
            if (!currentUser) {
                alert("Fa√ßa login primeiro!");
                return;
            }
            
            try {
                const userRef = db.collection("usuarios").doc(currentUser.id);
                await userRef.update({
                    saldo: firebase.firestore.FieldValue.increment(valor),
                    total_missoes: firebase.firestore.FieldValue.increment(1)
                });
                
                // Registrar miss√£o
                await db.collection("missoes").add({
                    user_id: currentUser.id,
                    valor: valor,
                    tipo: "missao_simples",
                    timestamp: new Date().toISOString()
                });
                
                mostrarStatusTemporario(`‚úÖ +R$ ${valor.toFixed(2)} adicionados ao saldo!`, "success");
                carregarSaldoUsuario();
                
            } catch (error) {
                console.error("Erro ao completar miss√£o:", error);
            }
        }
        
        async function participarGincana(valor) {
            if (!currentUser) {
                alert("Fa√ßa login primeiro!");
                return;
            }
            
            // Verificar saldo
            const userDoc = await db.collection("usuarios").doc(currentUser.id).get();
            const userData = userDoc.data();
            
            if ((userData.saldo || 0) < valor) {
                alert("‚ùå Saldo insuficiente! Deposite primeiro.");
                return;
            }
            
            try {
                // Debitar valor
                const userRef = db.collection("usuarios").doc(currentUser.id);
                await userRef.update({
                    saldo: firebase.firestore.FieldValue.increment(-valor)
                });
                
                // Registrar participa√ß√£o
                await db.collection("gincanas").add({
                    user_id: currentUser.id,
                    valor: valor,
                    gincana_id: "desafio_7_dias",
                    timestamp: new Date().toISOString(),
                    status: "participando"
                });
                
                mostrarStatusTemporario(`‚úÖ Inscri√ß√£o realizada! -R$ ${valor.toFixed(2)}`, "success");
                carregarSaldoUsuario();
                
            } catch (error) {
                console.error("Erro ao participar da gincana:", error);
            }
        }
        
        function criarNovaGincana() {
            alert("Funcionalidade em desenvolvimento!");
        }
        
        function criarNovaRifa() {
            alert("Funcionalidade em desenvolvimento!");
        }
        
        async function comprarNumeroRifa(valor) {
            if (!currentUser) {
                alert("Fa√ßa login primeiro!");
                return;
            }
            
            // Verificar saldo
            const userDoc = await db.collection("usuarios").doc(currentUser.id).get();
            const userData = userDoc.data();
            
            if ((userData.saldo || 0) < valor) {
                alert("‚ùå Saldo insuficiente! Deposite primeiro.");
                return;
            }
            
            try {
                // Debitar valor
                const userRef = db.collection("usuarios").doc(currentUser.id);
                await userRef.update({
                    saldo: firebase.firestore.FieldValue.increment(-valor)
                });
                
                mostrarStatusTemporario(`‚úÖ N√∫mero comprado! -R$ ${valor.toFixed(2)}`, "success");
                carregarSaldoUsuario();
                
            } catch (error) {
                console.error("Erro ao comprar n√∫mero:", error);
            }
        }
        
        async function comprarRapidinha(valor) {
            if (!currentUser) {
                alert("Fa√ßa login primeiro!");
                return;
            }
            
            // Verificar saldo
            const userDoc = await db.collection("usuarios").doc(currentUser.id).get();
            const userData = userDoc.data();
            
            if ((userData.saldo || 0) < valor) {
                alert("‚ùå Saldo insuficiente! Deposite primeiro.");
                return;
            }
            
            try {
                // Debitar valor
                const userRef = db.collection("usuarios").doc(currentUser.id);
                await userRef.update({
                    saldo: firebase.firestore.FieldValue.increment(-valor)
                });
                
                // Registrar bilhete
                await db.collection("rapidinhas").add({
                    user_id: currentUser.id,
                    valor: valor,
                    timestamp: new Date().toISOString(),
                    sorteio_id: "sorteio_atual"
                });
                
                mostrarStatusTemporario(`‚úÖ Bilhete comprado! -R$ ${valor.toFixed(2)}`, "success");
                carregarSaldoUsuario();
                
            } catch (error) {
                console.error("Erro ao comprar bilhete:", error);
            }
        }
        
        function sairConta() {
            if (confirm("Tem certeza que deseja sair?")) {
                // Limpar dados locais
                currentUser = null;
                isAdmin = false;
                
                // Recarregar p√°gina
                location.reload();
            }
        }
        
        // ==================== UTILIT√ÅRIOS ====================
        function mostrarStatusTemporario(mensagem, tipo) {
            // Criar elemento de status tempor√°rio
            const statusEl = document.createElement('div');
            statusEl.className = `status ${tipo}`;
            statusEl.textContent = mensagem;
            statusEl.style.position = 'fixed';
            statusEl.style.top = '20px';
            statusEl.style.left = '50%';
            statusEl.style.transform = 'translateX(-50%)';
            statusEl.style.zIndex = '9999';
            statusEl.style.maxWidth = '90%';
            
            document.body.appendChild(statusEl);
            
            // Remover ap√≥s 3 segundos
            setTimeout(() => {
                statusEl.remove();
            }, 3000);
        }
        
        function iniciarTimers() {
            // Timer da rapidinha
            let rapidinhaTimer = 300; // 5 minutos em segundos
            
            function atualizarTimerRapidinha() {
                const minutos = Math.floor(rapidinhaTimer / 60);
                const segundos = rapidinhaTimer % 60;
                const timerEl = document.getElementById('rapidinha-timer');
                
                if (timerEl) {
                    timerEl.textContent = `${minutos.toString().padStart(2, '0')}:${segundos.toString().padStart(2, '0')}`;
                    
                    if (rapidinhaTimer > 0) {
                        rapidinhaTimer--;
                        setTimeout(atualizarTimerRapidinha, 1000);
                    } else {
                        timerEl.textContent = "00:00";
                        timerEl.style.color = "#ff4081";
                    }
                }
            }
            
            atualizarTimerRapidinha();
        }
        
        // ==================== INICIALIZA√á√ÉO FINAL ====================
        console.log("‚úÖ RifasPay carregado com sucesso!");
        console.log("üëë ID do Admin:", ADMIN_TELEGRAM_ID);
        console.log("üîë API PixGo configurada");
        console.log("üî• Firebase conectado");
        
        // Verificar ambiente
        if (window.Telegram && Telegram.WebApp) {
            Telegram.WebApp.ready();
            Telegram.WebApp.expand();
            console.log("üì± Executando como MiniApp do Telegram");
        } else {
            console.log("üíª Executando no navegador");
        }
    </script>
</body>
</html>